<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Sets the character encoding of the document to UTF-8, ensuring proper rendering of international characters and symbols -->
  <meta charset="UTF-8">
  <title>Homepage</title>
  <!-- CSS Link -->
  <link rel="stylesheet" href="Admin_home_style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Boxicons CDN Link, Used to load the icons -->
  <script src="https://kit.fontawesome.com/14f233c83a.js" crossorigin="anonymous"></script>
  <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>
  <div class="sidebar">

    <div class="logo-details">
      <img src="images/logo.png" class="icon">
      <div class="logo_name">Club Mangment</div>
      <i class='bx bx-menu' id="btn"></i> <!-- the class name is taken from boxicons website -->
    </div>


    <ul class="nav-list">
      <li>
        <a href="Admin_home.html">
          <i class='bx bx-home'></i>
          <span class="links_name">Home</span>
        </a>
        <span class="tooltip">Home</span>
      </li>


      <li>
        <a href="Admin_weekly-Events.html">
          <i class='bx bx-calendar-event'></i>
          <span class="links_name">Weekly activities</span>
        </a>
        <span class="tooltip">Weekly activities</span>
      </li>


      <li>
        <a href="Admin_Incoming_requessts.html">
          <i class='bx bxl-telegram'></i>
          <span class="links_name">Event Requests</span>
        </a>
        <span class="tooltip">Event Requests</span>
      </li>


      <li>
        <a href="Admin_Incoming_post_requests.html">
          <i class='bx bx-detail'></i>
          <span class="links_name">Post Requests</span>
        </a>
        <span class="tooltip">Post Requests</span>
      </li>


      <li>
        <a href="Admin_create_club_page.html">
          <i class='bx bx-plus'></i>
          <span class="links_name">Create Club</span>
        </a>
        <span class="tooltip">Create Club</span>
      </li>


      <li class="profile">
        <div class="profile-details">
          <img src="images/profile.png" alt="profileImg">
          <div class="name_job">
            <div class="name">Micheal salman</div>
            <div class="job">Admin</div>
          </div>
        </div>
        <div>
          <a href="/">
            <i class='bx bx-log-out' id="log_out"></i>
          </a>
        </div>
      </li>


    </ul>
  </div>

  <!-- ======================================== -->

  <!-- homesection start -->
  <section class="home-section">
    
    <div class="nav-grid">
      <div class="text">
        HomePage
      </div>
      
      <div class="icon-1" onclick="toggleNotifi()">  <!-- notfication icon div -->
        <img class = "notfication-icon" src="images/Notification-icon.png" alt="">
      </div>
      <div class="notifi-box" id="box">
        <h2>Notifications </h2>

      </div>
    </div>
    
  <main>
    <div class="search-container">
      <div class="category-container">
          <div class="select-btn">
              <span class="btn-text">Select</span>
              <span class="arrow-dwn">
                  <i class="fa-solid fa-chevron-down"></i>
              </span>
          </div>
  
          <ul class="list-items">
              <li class="item">
                  <span class="checkbox">
                      <i class="fa-solid fa-check check-icon"></i>
                  </span>
                  <span class="item-text">MATH</span>
              </li>
          </ul>
      </div>
  
      <div class="search-form-container">
          <input type="text" class="input" placeholder="Search" id="search" />
          <button type="submit" class="button" id="submit">Search</button>
      </div>
  </div>
  
  <!-- Add a div to display the search results -->
  <div class="gallery" id="results-container"></div>
  
  
     <div class="gallery" id="club-gallery">
      <!-- Cards will be dynamically inserted here -->
  </div>
    </div>
    </main>
  </div>
  <script src="Admin_home_script.js">
  
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
        // Function to display search results
        function displaySearchResults(results) {
            const resultsContainer = document.getElementById('results-container');
            resultsContainer.innerHTML = ''; // Clear previous results

            // Loop through results and group them into rows of four
            results.forEach(club => {
              const card = document.createElement('div');
              card.classList.add('gallery-item', 'grid-colum-span');
              
              // Set the ID for each card, using `club-card-{index}` to distinguish them
              //card.id = `club-card-${index}`;
              // Set the card content
              card.innerHTML = `
                  <img src="${club.clubLogo}" alt="${club.clubName}" class="club-logo">
                  <h3>${club.clubName}</h3>
                  <p>${club.clubDescription}</p>
                  <p>President: ${club.clubPresident}</p>
                  <p>Vice President: ${club.clubVicePresident}</p>
              `;
                // Add the card to the results container
                resultsContainer.appendChild(card);
                card.addEventListener("click", async function() {
                  // Fetch the specific club information
                  const clubResponse = await fetch(`/api/Club/${club.clubID}`);
                  const clubData = await clubResponse.json();
                  
                  // Redirect to the club page with the club data as query parameters
                  // Constructing the URL with query parameters
                  window.location.href = `/club?clubID=${club.clubID}
                  &clubName=${encodeURIComponent(clubData.clubName)}
                  &clubDescription=${encodeURIComponent(clubData.clubDescription)}
                  &clubPresident=${encodeURIComponent(clubData.clubPresident)}
                  &clubVicePresident=${encodeURIComponent(clubData.clubVicePresident)}
                  &clubActivitiesInfo=${encodeURIComponent(clubData.clubActivitiesInfo)}
                  &clubOfficialEmail=${encodeURIComponent(clubData.clubOfficialEmail)}
                  &clubPresidentEmail=${encodeURIComponent(clubData.clubPresidentEmail)}
                  &clubVicePresidentEmail=${encodeURIComponent(clubData.clubVicePresidentEmail)}
                  &clubLogo=${encodeURIComponent(clubData.clubLogo)}`;
              });
            });
        }

        // Function to handle search
        function handleSearch() {
            const searchTerm = document.getElementById('search').value;

            fetch(`/api/Club/search/${searchTerm}`)
                .then(response => response.json())
                .then(displaySearchResults)
                .catch(error => {
                    console.error('Error fetching search results:', error);
                    const resultsContainer = document.getElementById('results-container');
                    resultsContainer.innerHTML = '<p>An error occurred while fetching search results.</p>';
                });
        }

        // Search button click event listener
        document.querySelector('#submit').addEventListener('click', handleSearch);

        // Optionally, you can also trigger search on pressing Enter in the input field
        document.getElementById('search').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                handleSearch();
            }
        });
    });
</script>

</body>
</html>
